{% extends 'base.html.twig' %}

{% block title %}Liste client
{% endblock %}

{% block body %}
	<header>
		<nav class="navbar navbar-expand-lg navbar-light bg-primary">
			<div class="container-fluid">
				<a class="navbar-brand text-light fw-bolder" href="/">{{title}}</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						<li class="nav-item">
							<a class="btn text-light" aria-current="page" href="/">Retour à l'accueil</a>
						</li>
						{% if is_granted('ROLE_ADMIN') %}
							<li>
								<a class="btn text-light" aria-current="page" href="{{path('client/add')}}">Ajout d'un client</a>
							</li>
						{% endif %}

					</ul>
				</div>
				{% if is_granted('ROLE_ADMIN') %}
					<span class="text-light">Nom utilisateur :
						{{user}}
						<a class="nav-link active text-light fw-normal" aria-current="page" href="/logout">Se déconnecter</a>
					{% else %}
						<a class="nav-link active text-light fw-normal" aria-current="page" href="/login">Se connecter</a>
					</span>
				{% endif %}

			</div>
		</nav>
	</header>
	<div class="container p-5">
		<div class="">

			<table id="table_id">

				<thead>
					<h1>
						<tr>
							<th>Nom</th> 
							<th>Prénom</th>
							<th>Modèle</th>
							{% if is_granted('ROLE_ADMIN') %}
								<th>Options</th>
								<th>Supprimer</th>
							{% endif %}

						</tr>
					</thead>
				</thead>
				<tbody>
					{% for client in listeAll %}
						{# <tr onclick="getClientId({{client.id}})"> #}
						<tr>
							<td>
								{{client.nom}}
							</td>
							<td>
								{{client.prenom}}
							</td>
							<td>
								{{client.modele}}
							</td>

							{% if is_granted('ROLE_ADMIN') %}
								<td scope="col">
									<a href="{{ path('client/update',{'id':client.id}) }}" class="btn btn-danger">Modifier le client</a>
								</td>
								<td>
									<a href="{{ path('client/delete',{'id':client.id}) }}" class="btn btn-danger">Supprimer le client</a>
								</td>
							{% endif %}

						</tr>
					{% endfor %}
				{# {{jsonFile}} #}
				</tbody>
			</table>


			<!-- Trigger/Open The Modal -->
			<button id="myBtn">Détails Client</button>

			<!-- The Modal -->
			<div
				id="myModal" class="modal">

				<!-- Modal content -->
				<div class="modal-content">
					<span class="close">&times;</span>
					<p>Nom: </p>
					<p>Prénom: </p>
					<p>Mail: </p>
					<p>Numéro de téléphone: </p>		
				</div>

			</div>

			<style>
				/* The Modal (background) */
				.modal {
					display: none; /* Hidden by default */
					position: fixed; /* Stay in place */
					z-index: 1; /* Sit on top */
					left: 0;
					top: 0;
					width: 100%; /* Full width */
					height: 100%; /* Full height */
					overflow: auto; /* Enable scroll if needed */
					background-color: rgb(0, 0, 0); /* Fallback color */
					background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
				}

				/* Modal Content/Box */
				.modal-content {
					background-color: #fefefe;
					margin: 15% auto; /* 15% from the top and centered */
					padding: 20px;
					border: 1px solid #888;
					width: 80%; /* Could be more or less, depending on screen size */
				}

				/* The Close Button */
				.close {
					color: #aaa;
					float: right;
					font-size: 28px;
					font-weight: bold;
				}

				.close:hover,
				.close:focus {
					color: black;
					text-decoration: none;
					cursor: pointer;
				}
			</style>

		</main>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js" integrity="sha512-n/4gHW3atM3QqRcbCn6ewmpxcLAHGaDjpEBu4xZd47N0W2oQ+6q7oc3PXstrJYXcbNU1OHdQ1T7pAP+gi5Yu8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.js"></script>
		<script>

			let table = new DataTable('#table_id', { // options
});
		</script>
		<script>
			// Get the modal
			var modal = document.getElementById("myModal");

			// Get the button that opens the modal
			var btn = document.getElementById("myBtn");

			// Get the <span> element that closes the modal
			var span = document.getElementsByClassName("close")[0];

			// When the user clicks on the button, open the modal
			btn.onclick = function () {
			modal.style.display = "block";
			}

			// When the user clicks on <span> (x), close the modal
			span.onclick = function () {
			modal.style.display = "none";
			}

			// When the user clicks anywhere outside of the modal, close it
			window.onclick = function (event) {
			if (event.target == modal) {
			modal.style.display = "none";
			}
			}
		</script>
		<script>

			//Récupérer l'id du client selectionné
			// function getClientId(clientIdGiven) {
			// 	var clientId = clientIdGiven;
				
			// //Création de l'objet XMLHttpRequest
			// var req = new XMLHttpRequest(); 
			
			//On initialise notre requête avec open()
			// req.open("GET", "http://localhost:8000/client/jsonFile");
			
			//Format de la réponse
			// req.responseType = "json";

			//Envoie de la requête
			// req.send();

			// console.log(req.response);
			}
		
			
		</script>
	{% endblock %}
